const githubJSONURL = 'https://raw.githubusercontent.com/jamtosing/votes/main/votingResults.json';

// Add a timestamp to the URL to prevent caching
const urlWithTimestamp = `${githubJSONURL}?t=${new Date().getTime()}`;

document.addEventListener('DOMContentLoaded', () => {
    fetch(urlWithTimestamp)  // Use the updated URL with timestamp
        .then(response => response.json()) // Fetch the JSON file
        .then(data => {
            const resultsContainer = document.getElementById('results');
            const loadingMessage = document.getElementById('loading');

            // Clear loading message
            loadingMessage.style.display = 'none';
            resultsContainer.style.display = 'block';

            // Loop through the results and display them
            data.forEach(song => {
                const songName = song.songName || "Unknown Song";
                const artistName = song.artistName || "Unknown Artist";
                const totalVotes = song.totalVotes || 0;

                const songItem = document.createElement('li');
                songItem.className = 'song-item';
                songItem.innerHTML = `
                    <h2>${songName} <span class="votes">(${totalVotes} votes)</span></h2>
                    <p>by ${artistName}</p>
                `;
                resultsContainer.appendChild(songItem);
            });
        })
        .catch(error => {
            console.error('Error fetching data:', error);
            document.getElementById('results').innerHTML = "<p>Could not load voting results. Please try again later.</p>";
        });
});
